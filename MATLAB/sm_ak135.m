function [vp_s,vs_s,rho_s]=sm_ak135(z,sm_fac)
% input the depth z, smooth_factor
% output [vp_s,vs_s,rho_s]
% test z=10;
% test sm_fac=10;

dep=0:1:260;
vp=[5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,5.800000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,6.500000,8.040000,8.040118,8.040235,8.040353,8.040471,8.040588,8.040706,8.040824,8.040941,8.041059,8.041176,8.041294,8.041412,8.041529,8.041647,8.041765,8.041882,8.042000,8.042118,8.042235,8.042353,8.042471,8.042588,8.042706,8.042824,8.042941,8.043059,8.043176,8.043294,8.043412,8.043529,8.043647,8.043765,8.043882,8.044000,8.044118,8.044235,8.044353,8.044471,8.044588,8.044706,8.044824,8.044941,8.045059,8.045176,8.045294,8.045412,8.045529,8.045647,8.045765,8.045882,8.046000,8.046118,8.046235,8.046353,8.046471,8.046588,8.046706,8.046824,8.046941,8.047059,8.047176,8.047294,8.047412,8.047529,8.047647,8.047765,8.047882,8.048000,8.048118,8.048235,8.048353,8.048471,8.048588,8.048706,8.048824,8.048941,8.049059,8.049176,8.049294,8.049412,8.049529,8.049647,8.049765,8.049882,8.050500,8.053267,8.056033,8.058800,8.061567,8.064333,8.067100,8.069867,8.072633,8.075400,8.078167,8.080933,8.083700,8.086467,8.089233,8.092000,8.094767,8.097533,8.100300,8.103067,8.105833,8.108600,8.111367,8.114133,8.116900,8.119667,8.122433,8.125200,8.127967,8.130733,8.133500,8.136267,8.139033,8.141800,8.144567,8.147333,8.150100,8.152867,8.155633,8.158400,8.161167,8.163933,8.166700,8.169467,8.172233,8.175000,8.177793,8.180587,8.183380,8.186173,8.188967,8.191760,8.194553,8.197347,8.200140,8.202933,8.205727,8.208520,8.211313,8.214107,8.216900,8.219693,8.222487,8.225280,8.228073,8.230867,8.233660,8.236453,8.239247,8.242040,8.244833,8.247627,8.250420,8.253213,8.256007,8.258800,8.261593,8.264387,8.267180,8.269973,8.272767,8.275560,8.278353,8.281147,8.283940,8.286733,8.289527,8.292320,8.295113,8.297907,8.300700,8.304330,8.307960,8.311590,8.315220,8.318850,8.322480,8.326110,8.329740,8.333370,8.337000,8.340630,8.344260,8.347890,8.351520,8.355150,8.358780,8.362410,8.366040,8.369670,8.373300,8.376930,8.380560,8.384190,8.387820,8.391450,8.395080,8.398710,8.402340,8.405970,8.409600,8.413230,8.416860,8.420490,8.424120,8.427750,8.431380,8.435010,8.438640,8.442270,8.445900,8.449530,8.453160,8.456790,8.460420,8.464050,8.467680,8.471310,8.474940,8.478570,8.482200];
vs=[3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.460000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,3.850000,4.480000,4.480235,4.480471,4.480706,4.480941,4.481176,4.481412,4.481647,4.481882,4.482118,4.482353,4.482588,4.482824,4.483059,4.483294,4.483529,4.483765,4.484000,4.484235,4.484471,4.484706,4.484941,4.485176,4.485412,4.485647,4.485882,4.486118,4.486353,4.486588,4.486824,4.487059,4.487294,4.487529,4.487765,4.488000,4.488235,4.488471,4.488706,4.488941,4.489176,4.489412,4.489647,4.489882,4.490118,4.490353,4.490588,4.490824,4.491059,4.491294,4.491529,4.491765,4.492000,4.492235,4.492471,4.492706,4.492941,4.493176,4.493412,4.493647,4.493882,4.494118,4.494353,4.494588,4.494824,4.495059,4.495294,4.495529,4.495765,4.496000,4.496235,4.496471,4.496706,4.496941,4.497176,4.497412,4.497647,4.497882,4.498118,4.498353,4.498588,4.498824,4.499059,4.499294,4.499529,4.499765,4.500000,4.500200,4.500400,4.500600,4.500800,4.501000,4.501200,4.501400,4.501600,4.501800,4.502000,4.502200,4.502400,4.502600,4.502800,4.503000,4.503200,4.503400,4.503600,4.503800,4.504000,4.504200,4.504400,4.504600,4.504800,4.505000,4.505200,4.505400,4.505600,4.505800,4.506000,4.506200,4.506400,4.506600,4.506800,4.507000,4.507200,4.507400,4.507600,4.507800,4.508000,4.508200,4.508400,4.508600,4.508800,4.509000,4.509209,4.509418,4.509627,4.509836,4.510044,4.510253,4.510462,4.510671,4.510880,4.511089,4.511298,4.511507,4.511716,4.511924,4.512133,4.512342,4.512551,4.512760,4.512969,4.513178,4.513387,4.513596,4.513804,4.514013,4.514222,4.514431,4.514640,4.514849,4.515058,4.515267,4.515476,4.515684,4.515893,4.516102,4.516311,4.516520,4.516729,4.516938,4.517147,4.517356,4.517564,4.517773,4.517982,4.518191,4.518400,4.520220,4.522040,4.523860,4.525680,4.527500,4.529320,4.531140,4.532960,4.534780,4.536600,4.538420,4.540240,4.542060,4.543880,4.545700,4.547520,4.549340,4.551160,4.552980,4.554800,4.556620,4.558440,4.560260,4.562080,4.563900,4.565720,4.567540,4.569360,4.571180,4.573000,4.574820,4.576640,4.578460,4.580280,4.582100,4.583920,4.585740,4.587560,4.589380,4.591200,4.593020,4.594840,4.596660,4.598480,4.600300,4.602120,4.603940,4.605760,4.607580,4.609400];
rho=[2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.720000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,2.920000,3.320000,3.320588,3.321176,3.321765,3.322353,3.322941,3.323529,3.324118,3.324706,3.325294,3.325882,3.326471,3.327059,3.327647,3.328235,3.328824,3.329412,3.330000,3.330588,3.331176,3.331765,3.332353,3.332941,3.333529,3.334118,3.334706,3.335294,3.335882,3.336471,3.337059,3.337647,3.338235,3.338824,3.339412,3.340000,3.340588,3.341176,3.341765,3.342353,3.342941,3.343529,3.344118,3.344706,3.320294,3.320882,3.321471,3.322059,3.322647,3.323235,3.323824,3.324412,3.325000,3.325588,3.326176,3.326765,3.327353,3.327941,3.328529,3.329118,3.329706,3.330294,3.330882,3.331471,3.332059,3.332647,3.333235,3.333824,3.334412,3.335000,3.335588,3.336176,3.336765,3.337353,3.337941,3.338529,3.339118,3.339706,3.340294,3.340882,3.341471,3.342059,3.342647,3.343235,3.343824,3.344412,3.426800,3.425562,3.424324,3.423087,3.421849,3.420611,3.419373,3.418136,3.416898,3.415660,3.414422,3.413184,3.411947,3.410709,3.409471,3.408233,3.406996,3.405758,3.404520,3.403282,3.402044,3.400807,3.399569,3.398331,3.397093,3.395856,3.394618,3.393380,3.392142,3.390904,3.389667,3.388429,3.387191,3.385953,3.384716,3.383478,3.382240,3.381002,3.379764,3.378527,3.377289,3.376051,3.374813,3.373576,3.372338,3.371100,3.370060,3.369020,3.367980,3.366940,3.365900,3.364860,3.363820,3.362780,3.361740,3.360700,3.359660,3.358620,3.357580,3.356540,3.355500,3.354460,3.353420,3.352380,3.351340,3.350300,3.349260,3.348220,3.347180,3.346140,3.345100,3.344060,3.343020,3.341980,3.340940,3.339900,3.338860,3.337820,3.336780,3.335740,3.334700,3.333660,3.332620,3.331580,3.330540,3.329500,3.328460,3.327420,3.326380,3.325340,3.324300,3.325140,3.325980,3.326820,3.327660,3.328500,3.329340,3.330180,3.331020,3.331860,3.332700,3.333540,3.334380,3.335220,3.336060,3.336900,3.337740,3.338580,3.339420,3.340260,3.341100,3.341940,3.342780,3.343620,3.344460,3.345300,3.346140,3.346980,3.347820,3.348660,3.349500,3.350340,3.351180,3.352020,3.352860,3.353700,3.354540,3.355380,3.356220,3.357060,3.357900,3.358740,3.359580,3.360420,3.361260,3.362100,3.362940,3.363780,3.364620,3.365460,3.366300];
s=zeros(length(dep),1);

for i=1:length(dep)
    s(i)=exp(-(z-dep(i))^2/sm_fac^2);
end
sums=sum(s);

vp_s=vp*s/sums;
vs_s=vs*s/sums;
rho_s=rho*s/sums;
return
